= link_to 'Back', reset_passwords_path, class: 'govuk-back-link'

%main.govuk-main-wrapper#main-content{role: 'main'}
  - if alert
    = render 'shared/errors'

  .govuk-grid-row
    .govuk-grid-column-two-thirds
      %h1.govuk-heading-l Reset your password
      %p
        We have sent a verification code to your email address. Enter your verification code and
        your new password below.
      %p
        If you havenâ€™t received the email, check your junk folder, or
        = link_to 'click here', reset_passwords_path
        to re-enter your
        details.
      %p
        Your password should:
      %ul.govuk-list-govuk-list--bullet
        %li
          %p Be at least 8 characters long
        %li
          %p Include at least one upper case letter
        %li
          %p Include at least one number
      = form_for(User.new, url: change_passwords_path, method: :post, html: {autocomplete: 'off'}) do |f|
        =f.hidden_field(:username, value: @username)
        .govuk-form-group{class: ('govuk-form-group--error' if alert && alert.downcase.include?('code'))}
          =f.label :confirmation_code, 'Enter your verification code', class: 'govuk-label'
          %span#govuk-error-message.govuk-error-message
            - if alert && alert.downcase.include?('code')
              %span.govuk-visually-hidden Error:
              = alert
          =f.text_field :confirmation_code, class: "govuk-input #{'govuk-input--error' if alert && alert.downcase.include?('code')}"

        .govuk-form-group{class: ('govuk-form-group--error' if alert && alert.downcase.include?('password'))}
          =f.label :password, 'Enter your password', class: 'govuk-label'
          %span.govuk-error-message
            - if alert && alert.downcase.include?('password')
              %span.govuk-visually-hidden Error:
              = alert
          =f.password_field :password, class: "govuk-input #{'govuk-input--error' if alert && alert.downcase.include?('password')}"

        .govuk-form-group{class: ('govuk-form-group--error' if alert && alert.downcase.include?('password'))}
          =f.label :password_confirmation, 'Confirm your password', class: 'govuk-label'
          %span.govuk-error-message
            - if alert && alert.downcase.include?('password')
              %span.govuk-visually-hidden Error:
              = alert
          =f.password_field :password_confirmation, class: "govuk-input #{'govuk-input--error' if alert && alert.downcase.include?('password')}"

        %br
        = f.submit 'Update password', class: 'govuk-button', 'data-module': 'govuk-button'
